Overview
========

This example demonstrates how to write a Fortran program that uses SiGMA to solve the Poisson equation.

Files included:
* `triangle_meshes.f90`: module for reading in Triangular meshes, as generated by the program [Triangle](http://www.cs.cmu.edu/~quake/triangle.html).
* `fe.f90`: using a triangular mesh, build the matrices used to solve the Poisson equation by the finite element method
* `poisson.f90`: main program, which uses the previous two modules to solve a real problem.
* `meshes/`: a script for generating an example Triangle mesh
* `read_mesh.py`: read a Triangle mesh into Python
* `plot_output.py`: generate a contour plot of the solution to the Poisson problem


Things to note
==============

The basic outline of what the main program does is as follows:

* read in a triangular mesh
* fill the finite element matrices
* generate a random right-hand side for the PDE solve
* make a solver and preconditioner for the linear system
* using these, solve the linear system
* write the output to a file

In this program, we used a trick to save memory. Both the stiffness matrix *A* and the mass matrix *B* of the linear system have the same exact connectivity structure. So, when we go to make the graph *g* which will represent that connectivity structure, we make both *A* and *B* share the graph object, rather than each one having its own copy.

However, we need to make absolutely sue that we destroy and deallocate the graph *g* when we are done with it, since it is a Fortran `pointer` object.

In order to enforce the boundary conditions for this problem, we modified elements of the stiffness matrix. For any unknown of the system associated to a boundary node, we replaced that row in the stiffness matrix with the equivalent row from the identity matrix. There are many other ways to enforce Dirichlet boundary conditions that we could have used.
